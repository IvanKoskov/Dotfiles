"use strict";var c=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var O=Object.prototype.hasOwnProperty;var R=(r,s)=>{for(var o in s)c(r,o,{get:s[o],enumerable:!0})},x=(r,s,o,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let e of w(s))!O.call(r,e)&&e!==o&&c(r,e,{get:()=>s[e],enumerable:!(t=v(s,e))||t.enumerable});return r};var b=r=>x(c({},"__esModule",{value:!0}),r);var A={};R(A,{default:()=>h});module.exports=b(A);var n=require("@raycast/api");async function p(r,s,o,t){let e=await(0,n.showToast)({style:n.Toast.Style.Animated,title:r});try{let i=await t();return e.style=n.Toast.Style.Success,e.title=s,{isSuccess:!0,result:i,toast:e}}catch(i){return console.error(i),e.style=n.Toast.Style.Failure,e.title=o,e.message=`${i}`,{isSuccess:!1,toast:e}}}var a=require("@raycast/api");var d=require("child_process"),f=require("util"),m=(0,f.promisify)(d.exec);function y(r,s){let o=new Map;for(let t of r){let e=s(t),i=o.get(e);i?i.push(t):o.set(e,[t])}return Array.from(o.keys()).map(t=>({key:t,values:o.get(t)??[]}))}var u=class r{static async xcodeRuntimeGroups(s){let o=await r.xcodeRuntimes();return y(o.filter(t=>s==="All"||t.platform===s),t=>t.platform).map(t=>({platform:t.key,runtimes:t.values})).sort((t,e)=>t.platform.localeCompare(e.platform))}static async xcodeRuntimes(){let s=await m("xcrun simctl list -j -v runtimes"),o=JSON.parse(s.stdout);if(!o||!o.runtimes)throw[];return o.runtimes.map(e=>{let i=Object.values(e.lastUsage||{}),l=i.length>0?new Date(Math.max(...i.map(S=>new Date(S).getTime()))):void 0,g=l&&l.getFullYear()===1?void 0:l;return{name:e.name,isSupported:e.isAvailable,platform:e.platform,version:e.version,buildVersion:e.buildversion,lastUsageDate:g}}).sort((e,i)=>i.buildVersion.localeCompare(e.buildVersion))}static async deleteXcodeRuntime(s){await m(`xcrun simctl runtime delete ${s.buildVersion}`)}static async deleteUnsupportedXcodeRuntimes(){let o=(await r.xcodeRuntimes()).filter(t=>t.isSupported===!1);for(let t of o)await r.deleteXcodeRuntime(t)}};var h=async()=>{let r={icon:a.Icon.Trash,title:"Delete unsupported runtimes",message:"Are you sure you want to delete all unsupported runtimes?",primaryAction:{title:"Delete",style:a.Alert.ActionStyle.Destructive}};await(0,a.confirmAlert)(r)&&await p("Deleting unsupported runtimes","Successfully deleted unsupported runtimes","An error occurred while trying to delete unsupported runtimes",u.deleteUnsupportedXcodeRuntimes)};
